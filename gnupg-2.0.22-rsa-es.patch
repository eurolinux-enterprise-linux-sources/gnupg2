diff -up gnupg-2.0.22/g10/misc.c.bz1233182 gnupg-2.0.22/g10/misc.c
--- gnupg-2.0.22/g10/misc.c.bz1233182	2015-06-17 13:15:32.930000000 +0200
+++ gnupg-2.0.22/g10/misc.c	2015-06-19 13:56:28.246000000 +0200
@@ -421,6 +421,8 @@ openpgp_cipher_algo_name (int algo)
 int
 map_pk_openpgp_to_gcry (int algo)
 {
+  if (is_RSA (algo))
+    return (GCRY_PK_RSA);
   switch (algo)
     {
     case PUBKEY_ALGO_ECDSA: return 301 /*GCRY_PK_ECDSA*/;
@@ -1417,7 +1419,7 @@ pubkey_nbits( int algo, gcry_mpi_t *key
 			      "(public-key(elg(p%m)(g%m)(y%m)))",
 				  key[0], key[1], key[2] );
     }
-    else if( algo == GCRY_PK_RSA ) {
+    else if( is_RSA (algo) ) {
 	rc = gcry_sexp_build ( &sexp, NULL,
 			      "(public-key(rsa(n%m)(e%m)))",
 				  key[0], key[1] );
